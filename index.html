<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio Target - C√°lculo de Comiss√£o</title>
    <style>
        /* Estilos CSS */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f4cf; padding: 16px; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 16px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        
        /* Estilo padr√£o para bot√µes */
        button { display: block; width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-bottom: 20px; font-weight: bold; }
        
        /* Bot√£o Calcular (Verde) */
        #btn-calcular { background-color: #2eab0f; color: white; }
        #btn-calcular:hover { background-color: #1b702d; }

        /* Bot√£o Voltar (Cinza) - Inicialmente escondido */
        #btn-voltar { background-color: #6c757d; color: white; display: none; }
        #btn-voltar:hover { background-color: #5a6268; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 8px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #007bff; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .valor-monetario { text-align: right; }
    </style>
</head>
<link rel="stylesheet" href="desafio.css">
    
    <div class="container">
        <h1>Relat√≥rio de Comiss√µes</h1>
        <p id="texto-instrucao">Bem vindo ao desafio TargetüéØ.</p>
        
        <div class="botoes-acao">
            <button id="btn-calcular" onclick="calcularComissoes()">Calcular e Exibir Relat√≥rio</button>

            <a href="Estoque.html">
                <button type="button" style="background-color: #007bff; color: white;">Ir para Estoque</button>
            </a>
            <a href="Juros_e_encargos.html">
                <button type="button" style="background-color: #6600ff; color: white;">Juros e Encargos</button>
            <a href="index.html">
                 <button type="button" style="background-color: #ffffff; color: rgb(0, 0, 0);">Inicio</button> 
                 </a>
        </div>

        <table id="tabela-resultados" style="display: none;">
            <thead>
                <tr>
                    <th>Vendedor</th>
                    <th class="valor-monetario">Total Vendido</th>
                    <th class="valor-monetario">Comiss√£o a Receber</th>
                </tr>
            </thead>
            <tbody id="corpo-tabela">
            </tbody>
        </table>
    </div>

    <script>
        const dadosJson = {
          "vendas": [
            { "vendedor": "Jo√£o Silva", "valor": 1200.50 },
            { "vendedor": "Jo√£o Silva", "valor": 950.75 },
            { "vendedor": "Jo√£o Silva", "valor": 1800.00 },
            { "vendedor": "Jo√£o Silva", "valor": 1400.30 },
            { "vendedor": "Jo√£o Silva", "valor": 1100.90 },
            { "vendedor": "Jo√£o Silva", "valor": 1550.00 },
            { "vendedor": "Jo√£o Silva", "valor": 1700.80 },
            { "vendedor": "Jo√£o Silva", "valor": 250.30 },
            { "vendedor": "Jo√£o Silva", "valor": 480.75 },
            { "vendedor": "Jo√£o Silva", "valor": 320.40 },
            { "vendedor": "Maria Souza", "valor": 2100.40 },
            { "vendedor": "Maria Souza", "valor": 1350.60 },
            { "vendedor": "Maria Souza", "valor": 950.20 },
            { "vendedor": "Maria Souza", "valor": 1600.75 },
            { "vendedor": "Maria Souza", "valor": 1750.00 },
            { "vendedor": "Maria Souza", "valor": 1450.90 },
            { "vendedor": "Maria Souza", "valor": 400.50 },
            { "vendedor": "Maria Souza", "valor": 180.20 },
            { "vendedor": "Maria Souza", "valor": 90.75 },
            { "vendedor": "Carlos Oliveira", "valor": 800.50 },
            { "vendedor": "Carlos Oliveira", "valor": 1200.00 },
            { "vendedor": "Carlos Oliveira", "valor": 1950.30 },
            { "vendedor": "Carlos Oliveira", "valor": 1750.80 },
            { "vendedor": "Carlos Oliveira", "valor": 1300.60 },
            { "vendedor": "Carlos Oliveira", "valor": 300.40 },
            { "vendedor": "Carlos Oliveira", "valor": 500.00 },
            { "vendedor": "Carlos Oliveira", "valor": 125.75 },
            { "vendedor": "Ana Lima", "valor": 1000.00 },
            { "vendedor": "Ana Lima", "valor": 1100.50 },
            { "vendedor": "Ana Lima", "valor": 1250.75 },
            { "vendedor": "Ana Lima", "valor": 1400.20 },
            { "vendedor": "Ana Lima", "valor": 1550.90 },
            { "vendedor": "Ana Lima", "valor": 1650.00 },
            { "vendedor": "Ana Lima", "valor": 75.30 },
            { "vendedor": "Ana Lima", "valor": 420.90 },
            { "vendedor": "Ana Lima", "valor": 315.40 }
          ]
        };

        function calcularComissoes() {
            const resumo = {};

            dadosJson.vendas.forEach(venda => {
                // Remove quebras de linha e espa√ßos extras do nome
                const nome = venda.vendedor.replace(/(\r\n|\n|\r)/gm, " ").trim();
                const valor = venda.valor;
                let comissaoDestaVenda = 0;

                if (valor < 100) {
                    comissaoDestaVenda = 0;
                } else if (valor < 500) {
                    comissaoDestaVenda = valor * 0.01;
                } else {
                    comissaoDestaVenda = valor * 0.05;
                }

                if (!resumo[nome]) {
                    resumo[nome] = { totalVendas: 0, totalComissao: 0 };
                }

                resumo[nome].totalVendas += valor;
                resumo[nome].totalComissao += comissaoDestaVenda;
            });

            exibirNaTabela(resumo);
        }

        function exibirNaTabela(resumo) {
            const tbody = document.getElementById('corpo-tabela');
            const tabela = document.getElementById('tabela-resultados');
            const btnCalcular = document.getElementById('btn-calcular');
            const btnVoltar = document.getElementById('btn-voltar');
            
            tbody.innerHTML = '';

            for (const vendedor in resumo) {
                const dados = resumo[vendedor];
                const vendasFormatado = dados.totalVendas.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
                const comissaoFormatada = dados.totalComissao.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

                const row = `
                    <tr>
                        <td>${vendedor}</td> 
                        <td class="valor-monetario">${vendasFormatado}</td>
                        <td class="valor-monetario"><strong>${comissaoFormatada}</strong></td>
                    </tr>
                `;
                tbody.innerHTML += row;
            }

            // A√á√ÉO VISUAL: Troca os bot√µes e mostra a tabela
            tabela.style.display = 'table';
            btnCalcular.style.display = 'none'; // Esconde o bot√£o verde
            btnVoltar.style.display = 'block';  // Mostra o bot√£o cinza
            document.getElementById('texto-instrucao').innerText = "C√°lculo realizado com sucesso.";
        }

        // NOVA FUN√á√ÉO: Reseta a tela para o estado inicial
        function resetarTela() {
            document.getElementById('tabela-resultados').style.display = 'none';
            document.getElementById('corpo-tabela').innerHTML = ''; // Limpa os dados
            
            document.getElementById('btn-voltar').style.display = 'none'; // Esconde bot√£o voltar
            document.getElementById('btn-calcular').style.display = 'block'; // Mostra bot√£o calcular
            
            document.getElementById('texto-instrucao').innerText = "Clique no bot√£o abaixo para processar o JSON e calcular os valores.";
        }
    </script>
</body>
</html>